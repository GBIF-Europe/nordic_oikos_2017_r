---
title:  "GBIF rgbif demo"
author: "Dag Endresen, GBIF.no, http://orcid.org/0000-0002-2352-5497"
date:   "February 2, 2018"
output: html_document
---

# Nordic Oikos 2018 - R workshop

Scientific reuse of openly published biodiversity information: Programmatic access to and analysis of primary biodiversity information using R. Nordic Oikos 2018, pre-conference R workshop. Further information [here](http://www.gbif.no/events/2018/Nordic-Oikos-2018-R-workshop.html).

* Sunday 18 Feb 2018, 10:00 - 17:00

* Monday 19 Feb 2018, 09:00 - 16:00

**Venue**: Auditorium [DU2-150](https://use.mazemap.com/#v=1&zlevel=-2&left=10.4044354&right=10.4080592&top=63.4160961&bottom=63.4145612&campusid=1&campuses=ntnu&sharepoitype=identifier&sharepoi=360-DU2-150), NTNU Gloeshaugen campus, Norwegian University of Science and Technology, Hoegskoleringen 5, NO-7491 Trondheim, Norway (latitude 63.415275, longitude 10.406295).



Set working directory, here: to the same directory as the RMD-script
```{r echo=FALSE, messages=FALSE}
#require(rstudioapi)
#setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
#getwd() ## will display the working directory
```




## Example - taxon liverleaf (blaaveis:no)
```{r message=FALSE}
require(rgbif) # r-package for accessing GBIF
sp_name <- "Hepatica nobilis" ## Choose your own species
#sp_name <- "Hordeum vulgare" ## Choose your own species
key <- name_backbone(name=sp_name, kingdom="Plantae")$speciesKey
```


## Example - GBIF data from Norway
```{r echo=FALSE, message=FALSE}
require(rgbif) # r-package for accessing GBIF data
sp <- occ_search(taxonKey=key, return="data", hasCoordinate=TRUE, country="NO", limit=300) 
gbifmap(sp, region = "norway")
```

## Example - global species occurrence data from GBIF
```{r message=FALSE}
#require(rgbif) # r-package for accessing GBIF
#sp <- occ_search(taxonKey=key, return="data", hasCoordinate=TRUE, limit=1000) 
#gbifmap(sp)
```

## Extract coordinates suitable for e.g. Maxent
```{r}
xy <- sp[c("decimalLongitude","decimalLatitude")] ## Extract only the coordinates
sp_xy <- sp[c("species", "decimalLongitude","decimalLatitude")] ## Input format for Maxent
#structure(sp_xy) ## preview the list of coordinates
head(sp_xy, n=4) ## preview first 4 records
```

## Write dataframe to file (useful for Maxent etc)
```{r}
#write.table(sp_xy, file="../demo_files/sp_xy.txt", sep="\t", row.names=FALSE, qmethod="double") ## for Maxent
```

## Read data file back into R
```{r}
#rm(sp_xy) ## remove vector sp_xy from the R workspace environment, before re-loading
#sp_xy <- read.delim("./sp_xy.txt", header=TRUE, dec=".", stringsAsFactors=FALSE)
```


GBIF demo examples for species: `r sp_name` (taxonKey:`r key`).

This script uses [R Markdown](http://rmarkdown.rstudio.com/)
